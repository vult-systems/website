---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/base-layout.astro';
import Header from '../../components/layout/header.astro';
import Footer from '../../components/layout/footer.astro';
import PageMain from '../../components/layout/page-main.astro';
import ContentHero from '../../components/content/content-hero.astro';
import ProseContent from '../../components/content/prose-content.astro';

export async function getStaticPaths() {
  const artPieces = await getCollection('art');
  return artPieces.map(art => ({
    params: { slug: art.slug },
    props: { art },
  }));
}

const { art } = Astro.props;
const { Content } = await art.render();

// Format metadata
const meta = art.data.category ? `â€¢ ${art.data.category}` : '';
const heroImageSrc = typeof art.data.heroImage === 'string' ? art.data.heroImage : art.data.heroImage?.src;
---

<BaseLayout
  title={`${art.data.title} | Art | Carlos Garcia`}
  description={art.data.description}
  image={heroImageSrc}
  type="article"
  keywords={art.data.tags?.join(', ')}
>
  <Header />
  <PageMain>
    <ContentHero
      title={art.data.title}
      description={art.data.description}
      meta={meta}
      heroImage={art.data.heroImage}
    />
    <ProseContent>
      <Content />
    </ProseContent>
  </PageMain>
  <Footer />
</BaseLayout>
